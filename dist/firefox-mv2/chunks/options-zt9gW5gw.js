import{r as c,b as l,j as e,c as w,R as C}from"./browser-Bh6BCD6u.js";const v={updateSiteIcon:!0,updateExtensionIcon:!0,enableNotifications:!0,keepPageAlive:!0,refreshInterval:1,notificationServerUrl:"https://notisky.symm.app",notificationServerUserId:""},E=()=>{const[t,h]=c.useState(v),[o,u]=c.useState("preferences"),[p,m]=c.useState(null),[d,r]=c.useState("checking"),[j,g]=c.useState([]);c.useEffect(()=>{f(),y()},[]),c.useEffect(()=>{k()},[]);const f=async()=>{try{const s=await l.storage.sync.get(v);h(s),console.log("Preferences loaded:",s)}catch(s){console.error("Error loading preferences:",s),x("Error loading preferences","error")}},N=async()=>{try{await l.storage.sync.set(t),console.log("Preferences saved:",t),x("Preferences saved!","success"),await l.runtime.sendMessage({action:"preferencesUpdated",preferences:t})}catch(s){console.error("Error saving preferences:",s),x("Error saving preferences","error")}},y=async()=>{try{const{accounts:s=[]}=await l.storage.local.get("accounts");g(s)}catch(s){console.error("Error fetching linked accounts:",s)}},k=async()=>{r("checking");try{const s="https://notisky.symm.app",n=await fetch(`${s}/api/status`,{method:"GET",headers:{"Content-Type":"application/json"},mode:"cors"}).catch(i=>{throw console.error("Fetch error:",i),i});if(n.ok){const i=await n.json();if(i.success){r("connected"),h(S=>({...S,notificationServerUrl:s}));return}else console.error("Server returned non-success status:",i),r("error")}else console.error("Server returned error status:",n.status),r("error")}catch(s){console.error("Error connecting to notification server:",s),r("error")}},x=(s,n)=>{m({text:s,type:n}),setTimeout(()=>{m(null)},3e3)},a=(s,n)=>{h({...t,[s]:n})},b=()=>{l.tabs.create({url:"https://notisky.symm.app"})};return e.jsxs("div",{className:"container",children:[e.jsxs("header",{className:"app-header",children:[e.jsx("img",{src:"../assets/icons/icon48.png",alt:"Notisky Logo",className:"logo"}),e.jsx("h1",{children:"Notisky Notifications"})]}),e.jsxs("div",{className:"tab-navigation",children:[e.jsx("div",{className:`tab ${o==="preferences"?"active":""}`,onClick:()=>u("preferences"),children:"Preferences"}),e.jsx("div",{className:`tab ${o==="accounts"?"active":""}`,onClick:()=>u("accounts"),children:"Accounts"}),e.jsx("div",{className:`tab ${o==="about"?"active":""}`,onClick:()=>u("about"),children:"About"})]}),e.jsxs("div",{className:`tab-content ${o==="preferences"?"active":""}`,id:"preferences-tab",children:[e.jsx("h2",{children:"Notification Settings"}),e.jsxs("div",{className:"toggle-container",children:[e.jsxs("div",{className:"toggle-option",children:[e.jsxs("div",{children:[e.jsx("div",{className:"option-label",children:"Update Website Icon"}),e.jsx("div",{className:"option-description",children:"Show notification count on the Bluesky website favicon"})]}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:t.updateSiteIcon,onChange:s=>a("updateSiteIcon",s.target.checked)}),e.jsx("span",{className:"slider"})]})]}),e.jsxs("div",{className:"toggle-option",children:[e.jsxs("div",{children:[e.jsx("div",{className:"option-label",children:"Update Extension Icon"}),e.jsx("div",{className:"option-description",children:"Show notification count on the extension icon"})]}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:t.updateExtensionIcon,onChange:s=>a("updateExtensionIcon",s.target.checked)}),e.jsx("span",{className:"slider"})]})]}),e.jsxs("div",{className:"toggle-option",children:[e.jsxs("div",{children:[e.jsx("div",{className:"option-label",children:"Enable Desktop Notifications"}),e.jsx("div",{className:"option-description",children:"Show desktop notifications for new activity"})]}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:t.enableNotifications,onChange:s=>a("enableNotifications",s.target.checked)}),e.jsx("span",{className:"slider"})]})]}),e.jsxs("div",{className:"toggle-option",children:[e.jsxs("div",{children:[e.jsx("div",{className:"option-label",children:"Background Checking"}),e.jsx("div",{className:"option-description",children:"Check for notifications in the background"})]}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:t.keepPageAlive,onChange:s=>a("keepPageAlive",s.target.checked)}),e.jsx("span",{className:"slider"})]})]})]}),e.jsxs("div",{className:"input-group visible",children:[e.jsx("label",{htmlFor:"refresh-interval",children:"Check Interval (minutes)"}),e.jsx("input",{type:"number",id:"refresh-interval",min:"1",max:"60",value:t.refreshInterval,onChange:s=>a("refreshInterval",parseInt(s.target.value)||1)})]}),e.jsx("div",{className:"action-buttons",children:e.jsx("button",{onClick:N,className:"primary-button",children:"Save Preferences"})}),p&&e.jsx("div",{className:`message ${p.type}`,children:p.text})]}),e.jsxs("div",{className:`tab-content ${o==="accounts"?"active":""}`,id:"accounts-tab",children:[e.jsx("h2",{children:"Bluesky Accounts"}),e.jsxs("div",{className:"accounts-section",children:[e.jsx("div",{className:"server-status-banner",children:e.jsxs("div",{className:`status-indicator ${d}`,children:[d==="checking"&&"Checking connection to Notisky server...",d==="connected"&&"Connected to Notisky authentication server",d==="error"&&"Error connecting to Notisky server"]})}),j.length>0?e.jsxs("div",{className:"accounts-list",children:[e.jsx("h3",{children:"Connected Accounts"}),j.map((s,n)=>e.jsx("div",{className:"account-card",children:e.jsxs("div",{className:"account-info",children:[e.jsxs("div",{className:"account-handle",children:["@",s.handle]}),e.jsx("div",{className:"account-did",children:s.did})]})},n))]}):e.jsx("div",{className:"no-accounts",children:e.jsx("p",{children:"No accounts connected yet."})}),e.jsx("div",{className:"auth-actions",children:e.jsx("button",{onClick:b,className:"primary-button",children:"Manage Accounts in Auth Portal"})}),e.jsx("div",{className:"accounts-help",children:e.jsx("p",{children:"Notisky uses the Authentication Portal to securely manage your Bluesky accounts. You can connect multiple accounts to receive real-time notifications from all of them."})})]})]}),e.jsxs("div",{className:`tab-content ${o==="about"?"active":""}`,id:"about-tab",children:[e.jsx("h2",{children:"About Notisky Notifications"}),e.jsx("p",{children:"Notisky is a browser extension that enhances Bluesky with notification features. It helps you stay updated with your Bluesky notifications without having to keep checking the site."}),e.jsxs("p",{children:[e.jsx("strong",{children:"Version:"})," 1.0.0"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Supported Browsers:"})," Chrome, Firefox, Safari"]}),e.jsx("p",{children:e.jsx("strong",{children:"Features:"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"Display notification count on the extension icon"}),e.jsx("li",{children:"Display notification count on the Bluesky tab favicon"}),e.jsx("li",{children:"Background notification checking"}),e.jsx("li",{children:"Desktop notifications"}),e.jsx("li",{children:"Real-time multi-account notifications via Notisky server"})]}),e.jsxs("div",{className:"auth-actions",children:[e.jsx("a",{href:"https://notisky.symm.app",target:"_blank",rel:"noopener noreferrer",className:"secondary-button",children:"Visit Auth Portal"}),e.jsx("a",{href:"https://github.com/symmetricalboy/notisky",target:"_blank",rel:"noopener noreferrer",className:"secondary-button",children:"GitHub Repository"})]})]}),e.jsxs("footer",{className:"app-footer",children:[e.jsx("p",{className:"footer-slogan",children:"Free & open source, for all, forever."}),e.jsxs("p",{className:"footer-contact",children:["Feedback, suggestions, assistance, & updates:",e.jsx("a",{href:"https://bsky.app/profile/symm.app",target:"_blank",rel:"noopener noreferrer",children:"@symm.app"})]}),e.jsx("p",{className:"footer-copyright",children:"Copyright (c) 2025 Dylan Gregori Singer (symmetricalboy)"})]})]})},I=w.createRoot(document.getElementById("root"));I.render(e.jsx(C.StrictMode,{children:e.jsx(E,{})}));
